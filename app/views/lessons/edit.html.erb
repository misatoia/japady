<h2 class="bg-light mb-4">教室情報の編集</h2>

<%= render 'layouts/error_messages', model: @lesson %>

<div class="row shadow mt-5 bg-white rounded">
    <div class="col-sm-8 p-4">
        <%= render 'lesson_form', lesson: @lesson %>

        <% if !@lesson.created_at.nil? %>
        <div class="mt-3">
            <%= form_with(model: @lesson, local: true, method: :delete, data: { confirm: "[確認]教室情報を削除します。この操作は元に戻せません。よろしいですか。" }) do |f| %>
                <%= f.submit 'この教室情報を削除する', class: 'btn btn-danger btn-block' %>
                <small class="">参加登録されている場合は削除できません。</small>
            <% end %>
        </div>
        <% end %>
    
    </div>
    <div class="col-sm-4 p-4">
        <% if !@lesson.created_at.nil? %>
            <p class="fs-1">
                出席者の削除・追加
            </p>
            <p class="fs-5">
                ここでの操作は教室の開催後に実際の出欠状況に応じて行ってください。
            </p>
            <div class="">
                <div class=""><%= "#{@lesson.attendances.count}人" %></div>
                <% @lesson.attendees.each do |attendee| %>
                <div><i class="fas fa-walking"></i> <%= link_to "#{attendee.nickname}さん", attendee %>
                    <%= link_to "[削除]", attendance_path(@lesson.attendances.find_by(user_id: attendee.id)), method: :delete %></div>
                <% end %>
            </div>
            <div class="form-group mt-5">
            <%= form_with(model: @lesson.attendances.build, local: true) do |f| %>
                <%= f.email_field :email, class: 'form-control', placeholder: 'name@example.com', required: true  %>
                <%= hidden_field_tag :lesson_id, @lesson.id %>
                <%= f.submit '出席者を追加', class: 'btn btn-primary btn-sm btn-block' %>
            <% end %>
            </div>


        <% end %>
    </div>
</div>
